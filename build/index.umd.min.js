!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ReactAutoSkeleton={},e.React)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(t),u=function(){return u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var u in t=arguments[n])Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u]);return e},u.apply(this,arguments)};function l(e,t,n){if(n||2===arguments.length)for(var r,u=0,l=t.length;u<l;u++)!r&&u in t||(r||(r=Array.prototype.slice.call(t,0,u)),r[u]=t[u]);return e.concat(r||Array.prototype.slice.call(t))}var i=[{match:function(e){var t=e.props.style;return!!t&&!!function(e){return"50%"===(null==e?void 0:e.borderRadius)||(null==e?void 0:e.borderRadius)>=999}(t)},skeleton:"circle"},{match:function(e){var t=e.props.style;return!(!(null==t?void 0:t.width)||!(null==t?void 0:t.height))},skeleton:"rect"},{match:function(e){return function(e){return(null==e?void 0:e.fontSize)||(null==e?void 0:e.lineHeight)}(e.props.style)},skeleton:"text"},{match:/^h[1-6]$/,skeleton:"text"},{match:"img",skeleton:"rect"}];function o(e,t){if("string"==typeof e)return t.type===e;if(e instanceof RegExp){var n="string"==typeof t.type?t.type:t.type.displayName||t.type.name;return e.test(n)}return e(t)}function a(e){var t=e.width,n=void 0===t?"100%":t,l=e.height,i=void 0===l?16:l,o=e.radius,a=void 0===o?4:o,f=e.style,c=e.className;return r.default.createElement("div",{className:c,style:u({width:n,height:i,borderRadius:a,background:"linear-gradient(90deg,#eee 25%,#f5f5f5 37%,#eee 63%)",backgroundSize:"400% 100%",animation:"skeleton 1.4s ease infinite"},f)})}function f(){return r.default.createElement(a,{width:40,height:40,radius:"50%"})}function c(){return r.default.createElement(a,{height:14})}function d(){return r.default.createElement(a,{height:40,radius:6})}var s=r.default.createContext(null);function p(e,n){var l;if("string"==typeof e)return r.default.createElement(c,null);if(!r.default.isValidElement(e))return null;var a=e.type,v=t.useContext(s),h=null==v?void 0:v.renderFromPlugin(e);if(h)return h;if(null==a?void 0:a.skeleton)return a.skeleton();var g=function(e,t){void 0===t&&(t=i);for(var n=0,r=t;n<r.length;n++){var u=r[n];if(o(u.match,e))return u.skeleton}return null}(e,null!==(l=null==v?void 0:v.getRules(n))&&void 0!==l?l:n);if(g&&"none"!==g)return function(e){switch(e){case"text":return r.default.createElement(c,null);case"rect":return r.default.createElement(d,null);case"circle":return r.default.createElement(f,null);default:return null}}(g);var m=r.default.Children.map(e.props.children,(function(e){return p(e,n)}));return r.default.cloneElement(e,u(u({},e.props),{children:m}))}var v=function(){function e(){this.plugins=[]}return e.prototype.use=function(e){this.plugins.push(e)},e.prototype.getRules=function(e){for(var t=l([],e,!0),n=0,r=this.plugins;n<r.length;n++){var u=r[n];u.rules&&(t=l(l([],u.rules,!0),t,!0))}return t},e.prototype.renderFromPlugin=function(e){for(var t,n=0,r=this.plugins;n<r.length;n++){var u=r[n],l=null===(t=u.renderSkeleton)||void 0===t?void 0:t.call(u,e);if(l)return l}return null},e}();e.AutoSkeleton=function(e){var t=e.loading,n=e.children,u=e.rules,l=e.plugins,o=void 0===l?[]:l,a=r.default.useMemo((function(){var e=new v;return o.forEach((function(t){return e.use(t)})),e}),[o]);return t?r.default.createElement(s.Provider,{value:a},p(n,null!=u?u:i)):r.default.createElement(r.default.Fragment,null,n)},e.SkeletonBase=a,e.SkeletonCircle=f,e.SkeletonRect=d,e.SkeletonText=c,e.useAutoSkeleton=function(e,t){void 0===t&&(t={});var n=t.loading,u=void 0===n||n,l=t.rules,o=void 0===l?i:l,a=t.plugins,f=void 0===a?[]:a,c=r.default.useMemo((function(){var e=new v;return f.forEach((function(t){return e.use(t)})),e}),[f]);return r.default.useMemo((function(){return u?r.default.createElement(s.Provider,{value:c},p(e,o)):e}),[u,e,o,c])},Object.defineProperty(e,"__esModule",{value:!0})}));
