import e,{useContext as n}from"react";var t=function(){return t=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},t.apply(this,arguments)};function r(e,n,t){if(t||2===arguments.length)for(var r,i=0,u=n.length;i<u;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))}var i=[{match:function(e){var n=e.props.style;return!!n&&!!function(e){return"50%"===(null==e?void 0:e.borderRadius)||(null==e?void 0:e.borderRadius)>=999}(n)},skeleton:"circle"},{match:function(e){var n=e.props.style;return!(!(null==n?void 0:n.width)||!(null==n?void 0:n.height))},skeleton:"rect"},{match:function(e){return function(e){return(null==e?void 0:e.fontSize)||(null==e?void 0:e.lineHeight)}(e.props.style)},skeleton:"text"},{match:/^h[1-6]$/,skeleton:"text"},{match:"img",skeleton:"rect"}];function u(e,n){if("string"==typeof e)return n.type===e;if(e instanceof RegExp){var t="string"==typeof n.type?n.type:n.type.displayName||n.type.name;return e.test(t)}return e(n)}function l(n){var r=n.width,i=void 0===r?"100%":r,u=n.height,l=void 0===u?16:u,o=n.radius,a=void 0===o?4:o,c=n.style,s=n.className;return e.createElement("div",{className:s,style:t({width:i,height:l,borderRadius:a,background:"linear-gradient(90deg,#eee 25%,#f5f5f5 37%,#eee 63%)",backgroundSize:"400% 100%",animation:"skeleton 1.4s ease infinite"},c)})}function o(){return e.createElement(l,{width:40,height:40,radius:"50%"})}function a(){return e.createElement(l,{height:14})}function c(){return e.createElement(l,{height:40,radius:6})}var s=e.createContext(null);function f(r,l){var d;if("string"==typeof r)return e.createElement(a,null);if(!e.isValidElement(r))return null;var v=r.type,p=n(s),h=null==p?void 0:p.renderFromPlugin(r);if(h)return h;if(null==v?void 0:v.skeleton)return v.skeleton();var g=function(e,n){void 0===n&&(n=i);for(var t=0,r=n;t<r.length;t++){var l=r[t];if(u(l.match,e))return l.skeleton}return null}(r,null!==(d=null==p?void 0:p.getRules(l))&&void 0!==d?d:l);if(g&&"none"!==g)return function(n){switch(n){case"text":return e.createElement(a,null);case"rect":return e.createElement(c,null);case"circle":return e.createElement(o,null);default:return null}}(g);var m=e.Children.map(r.props.children,(function(e){return f(e,l)}));return e.cloneElement(r,t(t({},r.props),{children:m}))}var d=function(){function e(){this.plugins=[]}return e.prototype.use=function(e){this.plugins.push(e)},e.prototype.getRules=function(e){for(var n=r([],e,!0),t=0,i=this.plugins;t<i.length;t++){var u=i[t];u.rules&&(n=r(r([],u.rules,!0),n,!0))}return n},e.prototype.renderFromPlugin=function(e){for(var n,t=0,r=this.plugins;t<r.length;t++){var i=r[t],u=null===(n=i.renderSkeleton)||void 0===n?void 0:n.call(i,e);if(u)return u}return null},e}();function v(n){var t=n.loading,r=n.children,u=n.rules,l=n.plugins,o=void 0===l?[]:l,a=e.useMemo((function(){var e=new d;return o.forEach((function(n){return e.use(n)})),e}),[o]);return t?e.createElement(s.Provider,{value:a},f(r,null!=u?u:i)):e.createElement(e.Fragment,null,r)}function p(n,t){void 0===t&&(t={});var r=t.loading,u=void 0===r||r,l=t.rules,o=void 0===l?i:l,a=t.plugins,c=void 0===a?[]:a,v=e.useMemo((function(){var e=new d;return c.forEach((function(n){return e.use(n)})),e}),[c]);return e.useMemo((function(){return u?e.createElement(s.Provider,{value:v},f(n,o)):n}),[u,n,o,v])}export{v as AutoSkeleton,l as SkeletonBase,o as SkeletonCircle,c as SkeletonRect,a as SkeletonText,p as useAutoSkeleton};
