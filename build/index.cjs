"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var u in t=arguments[n])Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u]);return e},r.apply(this,arguments)};function u(e,t,n){if(n||2===arguments.length)for(var r,u=0,l=t.length;u<l;u++)!r&&u in t||(r||(r=Array.prototype.slice.call(t,0,u)),r[u]=t[u]);return e.concat(r||Array.prototype.slice.call(t))}var l=[{match:function(e){var t=e.props.style;return!!t&&!!function(e){return"50%"===(null==e?void 0:e.borderRadius)||(null==e?void 0:e.borderRadius)>=999}(t)},skeleton:"circle"},{match:function(e){var t=e.props.style;return!(!(null==t?void 0:t.width)||!(null==t?void 0:t.height))},skeleton:"rect"},{match:function(e){return function(e){return(null==e?void 0:e.fontSize)||(null==e?void 0:e.lineHeight)}(e.props.style)},skeleton:"text"},{match:/^h[1-6]$/,skeleton:"text"},{match:"img",skeleton:"rect"}];function i(e,t){if("string"==typeof e)return t.type===e;if(e instanceof RegExp){var n="string"==typeof t.type?t.type:t.type.displayName||t.type.name;return e.test(n)}return e(t)}function o(e){var t=e.width,u=void 0===t?"100%":t,l=e.height,i=void 0===l?16:l,o=e.radius,a=void 0===o?4:o,c=e.style,s=e.className;return n.default.createElement("div",{className:s,style:r({width:u,height:i,borderRadius:a,background:"linear-gradient(90deg,#eee 25%,#f5f5f5 37%,#eee 63%)",backgroundSize:"400% 100%",animation:"skeleton 1.4s ease infinite"},c)})}function a(){return n.default.createElement(o,{width:40,height:40,radius:"50%"})}function c(){return n.default.createElement(o,{height:14})}function s(){return n.default.createElement(o,{height:40,radius:6})}var f=n.default.createContext(null);function d(t,u){var o;if("string"==typeof t)return n.default.createElement(c,null);if(!n.default.isValidElement(t))return null;var p=t.type,v=e.useContext(f),h=null==v?void 0:v.renderFromPlugin(t);if(h)return h;if(null==p?void 0:p.skeleton)return p.skeleton();var g=function(e,t){void 0===t&&(t=l);for(var n=0,r=t;n<r.length;n++){var u=r[n];if(i(u.match,e))return u.skeleton}return null}(t,null!==(o=null==v?void 0:v.getRules(u))&&void 0!==o?o:u);if(g&&"none"!==g)return function(e){switch(e){case"text":return n.default.createElement(c,null);case"rect":return n.default.createElement(s,null);case"circle":return n.default.createElement(a,null);default:return null}}(g);var m=n.default.Children.map(t.props.children,(function(e){return d(e,u)}));return n.default.cloneElement(t,r(r({},t.props),{children:m}))}var p=function(){function e(){this.plugins=[]}return e.prototype.use=function(e){this.plugins.push(e)},e.prototype.getRules=function(e){for(var t=u([],e,!0),n=0,r=this.plugins;n<r.length;n++){var l=r[n];l.rules&&(t=u(u([],l.rules,!0),t,!0))}return t},e.prototype.renderFromPlugin=function(e){for(var t,n=0,r=this.plugins;n<r.length;n++){var u=r[n],l=null===(t=u.renderSkeleton)||void 0===t?void 0:t.call(u,e);if(l)return l}return null},e}();exports.AutoSkeleton=function(e){var t=e.loading,r=e.children,u=e.rules,i=e.plugins,o=void 0===i?[]:i,a=n.default.useMemo((function(){var e=new p;return o.forEach((function(t){return e.use(t)})),e}),[o]);return t?n.default.createElement(f.Provider,{value:a},d(r,null!=u?u:l)):n.default.createElement(n.default.Fragment,null,r)},exports.SkeletonBase=o,exports.SkeletonCircle=a,exports.SkeletonRect=s,exports.SkeletonText=c,exports.useAutoSkeleton=function(e,t){void 0===t&&(t={});var r=t.loading,u=void 0===r||r,i=t.rules,o=void 0===i?l:i,a=t.plugins,c=void 0===a?[]:a,s=n.default.useMemo((function(){var e=new p;return c.forEach((function(t){return e.use(t)})),e}),[c]);return n.default.useMemo((function(){return u?n.default.createElement(f.Provider,{value:s},d(e,o)):e}),[u,e,o,s])};
